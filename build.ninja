builddir = build

include env.properties

rule cp
    command = cp $in $out

rule pdflatex
    command = bin/pdflatex.ninja.sh $in $out

rule gnuplot
    command = bin/gnuplot.ninja.sh $in $out

rule gmtFoam
    command = bin/gmtFoam.ninja.sh $in $case $time

build $builddir/thesis/thesis.pdf: $
  pdflatex src/thesis/thesis.tex $
| src/thesis/title.tex $
  src/thesis/mysouthall.tex $
  src/thesis/math.tex $
  src/thesis/thesis.bib $
  src/thesis/cubicFit.tex $
  src/thesis/cubicFit/deformationSphere.tex $
  src/thesis/cubicFit/interior-stencils.tex $
  src/thesis/cubicFit/double-upwind-stencil.tex $
  src/thesis/cubicFit/boundary-stencils.tex $
  $builddir/thesis/cubicFit/stabilisation.tex $
  $builddir/thesis/cubicFit/stabilisation.eps $
  $builddir/thesis/cubicFit/deformationSphere-gaussiansConvergence.tex $
  $builddir/thesis/cubicFit/deformationSphere-gaussiansConvergence.eps $
  $builddir/gmtFoam-figure/constant/mesh.pdf

build $builddir/thesis/cubicFit/stabilisation.tex $
| $builddir/thesis/cubicFit/stabilisation.eps: $
  gnuplot src/thesis/cubicFit/stabilisation.plt $
| src/thesis/cubicFit/centralQuad.dat $
  src/thesis/cubicFit/cubic.dat

build $builddir/thesis/cubicFit/deformationSphere-gaussiansConvergence.tex $
| $builddir/thesis/cubicFit/deformationSphere-gaussiansConvergence.eps: $
  gnuplot src/thesis/cubicFit/deformationSphere-gaussiansConvergence.plt

build thesis.pdf: cp $builddir/thesis/thesis.pdf

build $builddir/gmtFoam-figure/constant/mesh.pdf: $
  gmtFoam $builddir/gmtFoam-figure/constant/gmtDicts/mesh | $
  $builddir/gmtFoam-figure/constant/polyMesh/points $
  $builddir/gmtFoam-figure/constant/polyMesh/faces $
  $builddir/gmtFoam-figure/constant/polyMesh/owner $
  $builddir/gmtFoam-figure/constant/polyMesh/neighbour $
  $builddir/gmtFoam-figure/constant/polyMesh/boundary $
  $builddir/gmtFoam-figure/system/controlDict $
  $builddir/gmtFoam-figure/system/fvSchemes $
  $builddir/gmtFoam-figure/system/fvSolution
    time = constant
    case = $builddir/gmtFoam-figure

build $builddir/gmtFoam-figure/constant/gmtDicts/mesh: cp src/thesis/mesh.gmtdict
build $builddir/gmtFoam-figure/constant/polyMesh/points: cp $atmostests_builddir/schaerAdvect-mesh-btf/constant/polyMesh/points
build $builddir/gmtFoam-figure/constant/polyMesh/faces: cp $atmostests_builddir/schaerAdvect-mesh-btf/constant/polyMesh/faces
build $builddir/gmtFoam-figure/constant/polyMesh/owner: cp $atmostests_builddir/schaerAdvect-mesh-btf/constant/polyMesh/owner
build $builddir/gmtFoam-figure/constant/polyMesh/neighbour: cp $atmostests_builddir/schaerAdvect-mesh-btf/constant/polyMesh/neighbour
build $builddir/gmtFoam-figure/constant/polyMesh/boundary: cp $atmostests_builddir/schaerAdvect-mesh-btf/constant/polyMesh/boundary
build $builddir/gmtFoam-figure/system/controlDict: cp $atmostests_builddir/schaerAdvect-mesh-btf/system/controlDict
build $builddir/gmtFoam-figure/system/fvSchemes: cp src/thesis/fvSchemes.plotMesh
build $builddir/gmtFoam-figure/system/fvSolution: cp src/thesis/fvSolution.plotMesh

