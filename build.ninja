builddir = build

rule cp
    command = cp $in $out

rule rm
    command = rm -rf $in

rule pdflatex
    command = bin/pdflatex.ninja.sh $in $out

rule gnuplot
    command = bin/gnuplot.ninja.sh $in $out

rule gmtFoam
    command = bin/gmtFoam.ninja.sh $in $case $time

build $builddir/thesis/thesis.pdf: $
  pdflatex src/thesis/thesis.tex $
| src/thesis/title.tex $
  src/thesis/mysouthall.tex $
  src/thesis/thesis.bib $
  src/thesis/tikz-figure.tex $
  $builddir/thesis/gnuplot-figure.tex $builddir/thesis/gnuplot-figure.eps $
  $builddir/gmtFoam-figure/constant/mesh.pdf

build $builddir/thesis/gnuplot-figure.tex $
| $builddir/thesis/gnuplot-figure.eps: $
  gnuplot src/thesis/gnuplot-figure.plt

build thesis.pdf: cp $builddir/thesis/thesis.pdf

####

build $builddir/gmtFoam-figure/constant/mesh.pdf: $
  gmtFoam $builddir/gmtFoam-figure/constant/gmtDicts/mesh | $
  $builddir/gmtFoam-figure/constant/polyMesh/points $
  $builddir/gmtFoam-figure/constant/polyMesh/faces $
  $builddir/gmtFoam-figure/constant/polyMesh/owner $
  $builddir/gmtFoam-figure/constant/polyMesh/neighbour $
  $builddir/gmtFoam-figure/constant/polyMesh/boundary $
  $builddir/gmtFoam-figure/system/controlDict $
  $builddir/gmtFoam-figure/system/fvSchemes $
  $builddir/gmtFoam-figure/system/fvSolution
    time = constant
    case = $builddir/gmtFoam-figure

build $builddir/gmtFoam-figure/constant/gmtDicts/mesh: cp src/thesis/mesh.gmtdict
build $builddir/gmtFoam-figure/constant/polyMesh/points: cp src/thesis/gmtFoam-figure/constant/polyMesh/points
build $builddir/gmtFoam-figure/constant/polyMesh/faces: cp src/thesis/gmtFoam-figure/constant/polyMesh/faces
build $builddir/gmtFoam-figure/constant/polyMesh/owner: cp src/thesis/gmtFoam-figure/constant/polyMesh/owner
build $builddir/gmtFoam-figure/constant/polyMesh/neighbour: cp src/thesis/gmtFoam-figure/constant/polyMesh/neighbour
build $builddir/gmtFoam-figure/constant/polyMesh/boundary: cp src/thesis/gmtFoam-figure/constant/polyMesh/boundary
build $builddir/gmtFoam-figure/system/controlDict: cp src/thesis/gmtFoam-figure/system/controlDict
build $builddir/gmtFoam-figure/system/fvSchemes: cp src/thesis/gmtFoam-figure/system/fvSchemes
build $builddir/gmtFoam-figure/system/fvSolution: cp src/thesis/gmtFoam-figure/system/fvSolution

#build clean: rm $builddir
