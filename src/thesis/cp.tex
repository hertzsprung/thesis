\chapter{A new test case for exciting the Lorenz computational mode}
\label{ch:cp}

The Lorenz computational mode arises from one too many degrees of freedom in the Lorenz staggering of variables, and it is often excited by thermal forcing which can produce spurious, vertical grid-scale waves \citep{schneider1987,arakawa-konor1996}.
These errors have been observed in the Global Environmental Multiscale 3 model \citep{girard2014}, and the Korea Institute of Atmospheric Prediction Systems Integrated Model \citep{yi-park2017} amongst others, and these non-physical waves can lead to spurious rainfall in atmospheric models \citep{hollingsworth1995}, inaccurate simulations of idealised hurricanes \citep{zhu-smith2003}, and spurious instabilities in ocean models \citep{bell-white2017}.

The computational mode can be at least partially controlled by using sufficient vertical diffusion \citep{chang1992,zadra2004}, or by using a higher-order vertical discretisation \citep{untch-hortal2004,guerra-ullrich2016,yi-park2017}, but it can only be properly eliminated by choosing an alternative staggering of variables that removes the extra degree of freedom.  \TODO{or by filtering? \citep{thuburn-woolings2005}}
\TODO{Some folks have done exhaustive evaluations of staggerings \citep{thuburn-woolings2005,foxrabinovitz1996,holdaway2013a,holdaway2013b} C--P is, in some sense?, the best optimal staggering}

% why is C--P the best?
% - 

% who finds C--P to be superior to Lorenz?
% - fox-rabinovitz1996 dispersion analysis of 3D anelastic model
% - cullen1997 says C--P reduces spurious gravity waves, better geostrophic adjustment

% what are some of the drawbacks of C--P?
% - davies2005
% - hollingsworth2013

% what tests cases already exist?  why are they lacking?
% - arakawa-moorthi1988
%   - what is wrong with this test?
% - hollingsworth1995
%   - 2D model, heating at top, cooling at bottom
% - arakawa-konor1996
%   - standing waves
%   - baroclinic instability test again from arakawa-moorthi1988, does use horizontal finite differences, 2D with Coriolis I think
% - untch-hortal2004

The Charney--Phillips vertical staggering of variables \citep{charney-phillips1953} is suitable for structured meshes with cells stacked in columns.
This staggering has been adopted by several operational models \citep{davies2005,girard2014,yang2007} because it avoids the computational mode that is associated with the Lorenz vertical staggering \citep{arakawa-konor1996}.
The generalisation of the Lorenz staggering for arbitrary meshes is straightforward \citep{weller-shahrokhi2014} but this is not true for the Charney--Phillips staggering.
On a finite volume mesh, variables are ordinarily placed at cell centres or cell faces. In the Charney--Phillips staggering, the thermodynamic variable is placed at only those cell faces that lie on the vertical coordinate surfaces, and vertically-oriented faces have no thermodynamic information.
This existing staggering is unsuitable for arbitrary finite volume meshes because faces can have any orientation.

\input{cp/schaerWaves.tex}

\section{Advective-form transport for arbitrary Charney--Phillips meshes}

\TODO{describe the CP advection scheme: interpGrad+fvcReconstructCP (advective form)}

\input{cp/arakawaKonor.tex}

\section{Horizontal transport on distorted Charney--Phillips meshes}
\TODO{
\begin{itemize}
	\item Test: horizontal advection; advectiveFoamF, advectionFoam with linear interp, advectionFoam with linearUpwind interp; measure l2 and linf errors (s.t. they can be compared with cell-centred, C-grid results); uniform and edgeGraded meshes
	\item Plot: error fields, analytic+numerical contours of final solution, which schemes and which meshes? too many combinations to plot all of them
	\item Plot: time-series of conservation, ExnerFoamH and ExnerFoamCP, uniform mesh, horizontal edgeGrading, vertical edgeGrading
	\item Conclusion: advection is conservative on uniform meshes, non-conservative on non-uniform meshes
	\item Conclusion: advectiveFoamF errors are comparable to advectionFoam with linear interpolation?
	\item Conclusion: advectiveFoamF errors are worse than advectionFoam with linearUpwind interpolation?
\end{itemize}
}

