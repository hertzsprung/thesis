\chapter{High-order transport for arbitrary meshes}
\label{ch:highOrder}

\TODO{
Motivation
\begin{itemize}	
	\item cubicFit is suitable for flows over steep terrain but it is only second-order convergent despite having a large stencil and a cubic/quadratic polynomial
	\item existing high-order FV schemes exist, but are they more computationally expensive? or unsuitable for arbitrary meshes? identify applications of high-order FV schemes to atmospheric models
	\item we want to retain the low computational cost of cubicFit but achieve high-order convergence at the same time
\end{itemize}
}

A high-order transport scheme is ordinarily defined as one with a formal accuracy greater than second-order.
The order of convergence observed in numerical experiments may be less than the formal order of accuracy if the tracer field \TODO{ or velocity field?} is insufficiently smooth, and strong gradients in the form of weather fronts and temperature inversions mean that atmospheric fields are generally not smooth enough to obtain high-order convergence \citep{holdaway2008}. 
Even if high-order convergence is unattainable, high-order schemes can offer other advantages over second-order schemes: high-order schemes can reduce dispersion and diffusion errors \citep{ullrich-jablonowski2012,waruszewski2018}, reduce grid imprinting \citep{mccorquodale2015}, and increase the effective resolution of the scheme \citep{ullrich2014}.

% TODO: review existing high-order schemes
% what advantages does highOrderFit have?
% - arbitrary meshes
% - natural generalisation to 3D
% - same, cheap computational cost as cubicFit

% Waruszewski et al. 2018
% 3rd-order MPDATA
% Lax-Wendroff
% - tested on lat-lon meshes and 3D Cartesian meshes

% Li et al. 2013
% multi-moment constrained finite volume

% Ullrich et al. 2010
% Godunov-type method

% Sjögreen 2012 
% 3rd order upwind-biased stencil
% k-exact method

The cubicFit transport scheme acheives only second-order convergence even though it includes high-order polynomial terms.  The cubicFit scheme uses a sub-grid reconstruction that fits a polynomial over known values stored at cell centre points, and it is this point-wise approach that limits the scheme to second-order convergence.
\citet{devendran2017} developed a high-order finite volume scheme for solving Poisson’s equation, and they achieved high-order convergence by constraining the polynomial fit so that the average of the polynomial integrated over a cell volume equals the cell average value.
We apply their approach to obtain a transport scheme with high-order convergence.
Since it has much in common with the cubicFit transport scheme, we name this high-order transport scheme `highOrderFit'.

\input{highOrderFit/scheme}

\section{Horizontal transport on distorted meshes}
\TODO{
\begin{itemize}
	\item Test: horizontal flow on uniform and cubed-sphere-style Cartesian planes with Gaussian blob, periodic lateral boundary (use the same setup as deformationPlane, just change the velocity field)
	\item Plot: l2/linf convergence plot, cubicFit and highOrderFit
	\item Conclusion: should get fourth-order convergence
\end{itemize}
}

\begin{figure}
	\centering
	%
	\includegraphics{thesis/highOrderFit/deformationPlane/fig-meshes.pdf}
	%
	\caption{A distorted mesh on a Cartesian plane that has distortions similar to a cubed-sphere mesh.  This coarse distorted mesh has $60 \times 30$ cells such that $\Delta x = \ang{6}$.}
	\label{fig:highOrderFit:deformationPlane:mesh}
\end{figure}

\input{highOrderFit/deformationPlane.tex}

\section{Transport over mountains}

\TODO{
\begin{itemize}
\item Rerun section~\ref{sec:cubicFit:schaerAdvect} (and section~\ref{sec:cubicFit:tfAdvect}?)
\item Plot highOrderFit results directly onto figure~\ref{fig:cubicFit:schaerAdvect:convergence} (even though it's in the previous chapter)?
\item Using a cos squared tracer we'll only get second-order convergence but maybe absolute accuracy will be improved?
\item highOrderFit is unstable/inaccurate on BTF meshes right now, likely because it's missing cubicFit's stabilisation method
\end{itemize}
}
