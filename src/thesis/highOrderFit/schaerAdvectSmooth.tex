\section{High-order transport over mountains}
\label{sec:highOrderFit:schaerAdvectSmooth}

\TODO{
\begin{itemize}
\item test on BTF and cut cells, compare cubicFit and highOrderFit
\item Conclusion: 2nd-order convergence on uniform mesh with cubicFit
\item Conclusion: 4th-order convergence on uniform mesh with highOrderFit
\item Conclusion: 3rd-order convergence on BTF mesh with both schemes.  This is a surprise result for cubicFit!  Can we guess why this happens?
\item highOrderFit is unstable with more highly-distorted domains with more steeply sloping terrain, and this might well be because the stabilisation procedure from cubicFit is needed to remove high-order terms.
\end{itemize}
}

The test follows the specification by \citet{schaer2002}, with the same domain size and boundary conditions as in section~\ref{sec:cubicFit:schaerAdvect}.
The mountain profile is given by equation~\eqref{eqn:cubicFit:schaerAdvect:mountain} and the prescribed velocity field is given by equation~\eqref{eqn:cubicFit:schaerAdvect:velocity}.
As originally specified by \citet{schaer2002}, the peak mountain height $h_0 = \SI{3}{\kilo\meter}$, and the transtion from zero flow near the ground to uniform horizontal flow aloft occurs between $z_1 = \SI{4}{\kilo\meter}$ and $z_2 = \SI{5}{\kilo\meter}$.
All other parameters relating to the mountain profile and velocity field are the same as those given in section~\ref{sec:cubicFit:schaerAdvect}.

The tracer density is given by equation~\eqref{eqn:cubicFit:schaerAdvect:tracer} and is centred at $(x_0, z_0) = (\SI{-50}{\kilo\meter}, \SI{9}{\kilo\meter})$.  In order to allow high-order convergence to be achieved, the exponent $\rhoexp = 4$ such that the $\cos^\rhoexp$ hill has $\rhoexp - 1$ continuous derivatives \citep{holdaway2008}.
All other tracer parameters are the same as those given in section~\ref{sec:cubicFit:schaerAdvect}.

Tests are integrated for \SI{10000}{\second} using the classical fourth-order Rungeâ€“Kutta time-stepping scheme \citep[p. 53]{durran2013} with both cubicFit and highOrderFit transport schemes, and tests are integrated using a time-step chosen for each mesh so that the maximum Courant number is about \num{0.4}.  
The analytic solution at $t = \SI{10000}{\second}$ is centred at $(x_0, z_0) = (\SI{50}{\kilo\meter}, \SI{9}{\kilo\meter})$.


\begin{figure}
	\centering
	%
	\input{highOrderFit/schaerAdvectSmooth/convergence}
	%
	\caption{Numerical convergence in a test transporting a $\cos^4$ tracer horizontally over mountains.
	$\ell_2$ (equation~\ref{eqn:l2-error}) and $\ell_\infty$ errors (equation~\ref{eqn:linf-error}) are marked at mesh spacings between $\Delta x = \SI{5000}{\meter}$ and $\Delta x = \SI{250}{\meter}$ using cubicFit and highOrderFit transport schemes on basic terrain-following and cut cell meshes.}
	\label{fig:highOrderFit:schaerAdvectSmooth:convergence}
\end{figure}
