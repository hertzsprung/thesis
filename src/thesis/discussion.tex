\chapter{Discussion}
\label{ch:discussion}

Atmospheric models are using increasingly fine horizontal mesh spacings that resolve steep slopes in terrain resulting in highly-distorted meshes and increased numerical errors.
This thesis makes four contributions to reduce numerical errors for flows over steep slopes.
First, we presented a new multidimensional method-of-lines transport scheme, cubicFit, that enforces stability conditions derived from a von Neumann stability analysis to make the scheme stable over steep terrain on highly-distorted, arbitrary meshes.
The scheme has a low computational cost at runtime, requiring only $m$ multiplies per face per time-stage using a stencil with $m$ cells.
Stability condition calculations are pre-computed during model initialisation since they depend upon the mesh geometry only.
A new transport test case with a terrain-following velocity field was formulated which reveals that numerical transport errors are primarily due to misalignment of the velocity field with mesh layers and not simply mesh distortions.
In all tests, compared to the multidimensional linear upwind scheme, the cubicFit scheme is more stable and more accurate.
The cubicFit transport scheme is second-order convergent on two-dimensional meses over steeply sloping terrain, cubed sphere meshes and hexagonal-icosahedral meshes, irrespective of the velocity field or mesh distortions.

Second, a high-order multidimensional method-of-lines transport scheme, highOrderFit, is developed.
The highOrderFit scheme uses high-order \kexact{} polynomial reconstructions that are obtained by calculating high-order volume and surface moments exactly.
All computationally expensive reconstruction calculations depend on the mesh geometry alone.
During integration, the highOrderFit scheme requires only $m$ multiplies per face per time-stage using a stencil of $m$ cells, meaning that the highOrderFit scheme has the same computational cost at runtime as the cubicFit scheme.
Transport tests demonstrate that the highOrderFit scheme achieves at least third-order convergence irrespective of the velocity field or mesh distortions.

Third, we proposed a new type of mesh, the slanted cell mesh, for representing the atmosphere above steeply sloping terrain.
The slanted cell mesh is designed to avoid severe mesh distortions associated with terrain-following meshes, and to avoid severe time-step constraints associated with arbitrarily small cut cells.
In a test of a stratified atmosphere at rest, spurious circulations were reduced by switching from the highly-distorted basic terrain-following mesh to the more uniform slanted cell mesh.
A new test case was formulated to challenge transport schemes over a steeply sloping lower boundary.
Unlike the multidimensional linear upwind scheme, the cubicFit scheme is numerically stable over these very steep slopes.
The test reveals that the slanted cell mesh permits longer time-steps than those permitted on cut cell meshes, since slanted cells are always long in the direction of flow.

Finally, a two-dimensional test case was developed to excite the Lorenz computational mode, based on the original test specification by \citet{arakawa-konor1996}. \TODO{remind readers what motivated this new test}
Test results were compared using two models of fully compressible Euler equations: one variant having a Lorenz staggering, and the other model variant using a newly-formulated Charney--Phillips staggering generalised for arbitrary meshes.
The test case verifies that the generalised Charney--Phillips model variant is free from the Lorenz computational mode, and we hope that the new test case might aid in the development and intercomparison of future dynamical cores.

\section{Future work}

All tests presented with $x$--$z$ meshes have used only uniform vertical mesh spacing.
Operational atmospheric models have non-uniform vertical mesh spacing, using finer mesh spacing near the ground to resolve boundary layer processes \citep[p. 547]{chow2013}.
Terrain-following meshes naturally accommodate non-uniform vertical mesh spacing, with each column having the same number of cells.
However, to resolve boundary layer processes above elevated terrain, cut cell meshes must use fine vertical mesh spacing everywhere from sea level to the highest mountain peak, resulting in a greater computational cost compared to the equivalent terrain-following mesh \citep{walko-avissar2008b}.
The same problem is true for slanted cell meshes.
Fine vertical mesh spacing near the ground is also desirable for resolving diurnal flows along mountain slopes, which have a typical depth from \SIrange{1}{20}{\meter} \citep[p. 39]{chow2013}.
Since we have established that the numerical accuracy of a transport scheme depends primarily on the alignment of flow with the mesh (section~\ref{sec:cubicFit:tfAdvect}), we might expect a terrain-following mesh to be better-suited than cut a cell mesh for representing slope flows.
The tests presented here demonstrate that a more accurate balance between the pressure gradient and gravity is achieved using cut cell meshes or slanted cell meshes (section~\ref{sec:slanted:resting}), but that transport over mountain slopes is more accurate using terrain-following meshes (section~\ref{sec:slanted:mountainAdvect}).
Hence, future work might seek an improved mesh that blends the best features of both terrain-following and slanted cell meshes.

As well as developing the slanted cell method that reduces mesh distortions over steep terrain, we have also made progress towards achieving numerically stable and accurate transport on arbitrary, highly-distorted meshes.
The highOrderFit transport scheme offers a promising route to obtaining high-order convergence with a low computational cost, but we are aware of three improvements that could be investigated.
First, the highOrderFit scheme achieves high-order convergence that makes it more accurate than the cubicFit scheme at finer mesh spacings but, at coarser mesh spacings, the cubicFit scheme is most accurate.
For both transport schemes, the multipliers that appear in the weighted least-squares fit are used to ensure that the polynomial fits almost exactly through the upwind and downwind cell values, and this is necessary to achieve stability on highly-distorted meshes.
On less distorted meshes, however, more accurate results can be obtained by modifying the multiplier values so that the polynomial has a less exact fit through the upwind and downwind cell values, but has better least-squares fit to the stencil overall.
\citet{devendran2017} note that these multipliers introduce extra degrees of freedom into the system, and a strategy for optimising these values is the subject of future work.
We hope that if such a strategy were included in the highOrderFit scheme then more accurate results could be obtained on coarser meshes.

Second, by selectively removing high-order polynomial terms for highly-distorted stencils, the cubicFit scheme achieves stable results where, on the same mesh, the highOrderFit scheme is unstable.
We expect that a similar stabilisation procedure could be included in the highOrderFit scheme to obtain stable results on more highly-distorted meshes.
This stabilisation procedure should also permit stable transport over arbitrary lower boundaries and, to further improve accuracy near boundaries, high-order boundary conditions might be derived following existing approaches \citep{devendran2017,schwartz2015}.

Third, the highOrderFit scheme has only been tested on Cartesian planes, and further research is necessary to extend the scheme to spherical geometry.
It is not clear that a projection from the sphere onto a local tangent plane, as used by \citet{sjoegreen2012}, will achieve high-order convergence.
Instead, it is more likely that high-order convergence could be achieved by taking the method by \citet{tuzikov2003} for calculating exactly polyhedral surface and volume moments and extending it to spherical polyhedra.

