\chapter{A new mesh for representing the atmosphere above terrain}
\label{ch:slanted}

\begin{highlights}
{\Large Highlights}
\begin{itemize}
	\item The new slanted cell mesh permits longer time-steps than cut cells, with time-steps comparable to terrain-following meshes
	\item Pressure gradient calculations are more accurate using the new slanted cell method compared to terrain-following methods
	\item Unlike the multidimensional linear upwind scheme, the cubicFit scheme is numerically stable over very steep slopes
\end{itemize}
\end{highlights}

Two sources of numerical error receive particular attention in atmospheric models: errors associated with transport terms and errors associated with the pressure gradient term.
The previous chapter developed the cubicFit transport scheme that reduced numerical errors associated with transport over mountains.
This chapter seeks to reduce errors associated with pressure gradient calculations by representing the atmosphere above terrain using a new type of mesh, the slanted cell mesh.

\TODO{a paragraph giving an overview of the issues we'll be discussing and confronting}

Terrain-following meshes are typically implemented using a coordinate transform that introduces metric terms into the equations of motion.  The horizontal pressure gradient $\left. \partial p / \partial x \right|_z$ can be written as \citep{mahrer1984}
\begin{align}
	\left. \frac{\partial p}{\partial x} \right|_z = 
	\left. \frac{\partial p}{\partial x} \right|_{z^\star} +
	\left. \frac{\partial z^\star}{\partial x} \right|_z
	\frac{\partial p}{\partial z^\star} \label{eqn:slanted:dpdx}
\end{align}
where $\left. \partial / \partial x \right|_z$ denotes a horizontal derivative at a fixed height in the physical domain, and $\left. \partial / \partial x \right|_{z^\star}$ denotes a horizontal derivative at a fixed model level in the computational domain.  The first term on the right hand side of equation~\eqref{eqn:slanted:dpdx} is the change in pressure along the terrain-following coordinate surfacee, and the second term corrects for the vertical contribution in the first.
These terms tend to be large and of opposite sign over steep terrain, and cancellation errors between the two terms result in pressure gradients errors that drive spurious flows \citep{fast2003}.

There are two main approaches to minimizing errors associated with terrain-following meshes.
First, by smoothing the effects of terrain with height, the influence of the terrain is reduced, hence pressure gradient errors are also reduced aloft \citep{schaer2002,leuenberger2010,klemp2011}.
Second, numerical errors can also be reduced by improving the accuracy in calculating the horizontal pressure gradient itself.  Instead of calculating the horizontal pressure gradient in the computational domain, the techniques proposed by \citet{klemp2011} and \citet{zaengl2012} both involve interpolation onto $z$ levels in the physical domain in order to calculate the horizontal pressure gradient.  This gave them the flexibility to design more accurate horizontal pressure gradient discretizations using more appropriate stencils.
%The technique proposed by \citet{weller-shahrokhi2014} involves calculating pressure gradients in the direction aligned with the mesh, thus ensuring curl-free pressure gradients and improved accuracy.

Cut cell meshes are more regular than any smoothed terrain-following mesh, and some studies have shown examples where cut cells produce more accurate results when compared to terrain-following meshes.
Spurious winds seen using terrain-following meshes are not present with cut cells and errors do not increase with steeper terrain \citep{good2014}.
A comparison of terrain-following and cut cell meshes using real initial data by \citet{steppeler2013} found that 5-day forecasts of precipitation and wind over Asia in January 1989 were more accurate in the cut-cell model, although this result was dependent on using an old version of a model.
\TODO{however, cut cells can be arbitrarily small}

\TODO{say something about complexity of mesh generation: SLEVE coordinate transform is non-monotonic if parameter values are poorly chosen; cut cell meshes are constructed using a level set method... citation?}

We seek a new type of mesh that improves pressure gradient calculations compared to terrain-following methods, and avoids the severe time-step constraints associated with arbitrarily small cut cells.  Section~\ref{sec:slanted:method} describes the slanted cell method which is designed to satisfy these criteria.
Section~\ref{sec:slanted:mountainAdvect} presents a new two-dimensional test that challanges transport schemes by transporting a tracer along the ground through slanted cells.
Section~\ref{sec:slanted:exnerFoamH} outlines the discretisation of the fully compressible model taken from \citet{weller-shahrokhi2014} which includes a curl-free pressure gradient formulation.  In section~\ref{sec:slanted:resting}, the fully compressible model is used to simulate a standard resting atmosphere test case \citep{klemp2011}, comparing results using terrain-following, cut cell and slanted cell meshes.

\input{slanted/method.tex}
\input{slanted/mountainAdvect.tex}
\input{slanted/exnerFoamH.tex}
\input{slanted/resting.tex}
